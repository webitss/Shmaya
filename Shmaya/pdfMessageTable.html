<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<style>
	table {
		font-family: arial, sans-serif;
		border-collapse: collapse;
		width: 100%;
	}

	td, th {
		border: 1px solid #dddddd;
		text-align: left;
		padding: 8px;
	}

	tr:nth-child(even) {
		background-color: #dddddd;
	}
</style>
<body ng-app= "pdfApp" ng-controller="MessageInPdfCtrl">
	<table>
		<tr>
			<th>שם לקוח</th>
			<th>שם מתורגמן</th>
			<th>סוג הזמנה</th>
			<th>סוג תרגום</th>
			<th>תאריך תרגום</th>
			<th>זמן תרגום</th>
		</tr>
		<tr ng-repeat="order in OrdersList">
			<td>{{order.nameCustomer}}</td>
			<td>{{order.nameTranslator}}</td>
			<td>{{order.typeOrder}}</td>
			<td>{{order.typeTranslation}}</td>
			<td>{{order.dtDateTraslation}}</td>
			<td>{{order.dtTimeTranslation}}</td>
		</tr>
	</table>
	<table>
		<tr>
			<th>זמן תרגום</th>
			<th>סה"כ לתשלום</th>
			<th>תשלום שעה ראשונה</th>
			<th>תשלום שעה שניה</th>
		</tr>
		<tr ng-repeat="customer in CustomersList">
			<td>{{customer.dtTimeTranslation}}</td>
			<td>{{customer.nSumPayment}}</td>
			<td>{{customer.nTariffToFirst}}</td>
			<td>{{customer.nTariffToSecond}}</td>
		</tr>
	</table>
	<script src="Scripts/Libraries/jquery-3.1.1.min.js"></script>
	<script src="Scripts/Libraries/jquery-ui.min.js"></script>
	<script src="Scripts/Libraries/jquery.flip.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.7/angular.js"></script>
	<script src="Scripts/Libraries/bootstrap/js/bootstrap.min.js"></script>
	<script src="Scripts/Libraries/angular-bootstrap-multiselect.js"></script>
	<script src="Scripts/Libraries/ui-bootstrap-tpls-2.4.0.min.js"></script>
	<script type="text/javascript">
		var pdfApp = angular.module('pdfApp', []);
	</script>
	<script src="Scripts/Factories/ConnectForPdf.js"></script>
	<script type="text/javascript">
		pdfApp.controller('MessageInPdfCtrl', ['$scope', '$rootScope', '$timeout', '$window', 'ConnectForPdf', '$location',
			function ($scope, $rootScope, $timeout, $window, ConnectForPdf, $location) {
				function getParameterByName(name, url) {
					if (!url) url = window.location.href;
					name = name.replace(/[\[\]]/g, "\\$&");
					var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
						results = regex.exec(url);
					if (!results) return null;
					if (!results[2]) return '';
					return decodeURIComponent(results[2].replace(/\+/g, " "));
				}

				$scope.prepareData = function () {
					$scope.UserId = parseInt(getParameterByName('iUserId'));//parseInt($routeParams.iUserId);
					$scope.dateBegin = new Date(getParameterByName('dtDateBegin'));
					$scope.dateEnd = new Date(getParameterByName('dtDateEnd'));

					$scope.getData1();
					$scope.getData2();


				};
				$scope.getData1 = function () {
					ConnectForPdf.post('GetOrdersByStatus', { iUserId: $scope.UserId },
						function (result) {
							$scope.OrdersList = result;
							$scope.isDataLoaded++;
						});
				};
				$scope.getData2 = function () {
					ConnectForPdf.post('GetMessageToProvider', { iUserId: $scope.UserId, dtBeginDate: $scope.dateBegin, dtEndDate: $scope.dateEnd },
						function (result) {
							$scope.CustomersList = result;
							$scope.isDataLoaded2++;
						});
				};
				$scope.prepareData();
				//setTimeout($scope.getData2(), 10000);
			}]);
	</script>

</body>
</html>